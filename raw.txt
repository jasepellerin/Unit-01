units:
  halfKeyW: 0.5 cx
  halfKeyH: 0.5 cy
  paddingX: 1
  paddingY: 1
  pinkyRotate: 5
  ringRotate: -5
  indexRotate: -2
  innerRotate: -2
  thumbRotate: -10
  thumbFarRotate: -4
points:
  key:
    padding: cy
    footprints:
      - type: choc
        anchor:
          rotate: 180
        nets:
          from: GND
          to: =key_net
        params:
          reverse: true
          keycaps: true
  zones:
    matrix:
      rows:
        bottom:
        home:
        top:
      columns:
        pinky:
          rotate: pinkyRotate
          rows:
            top.skip: true
            home.key_net: P21
            bottom.key_net: P20
        ring:
          rotate: ringRotate
          stagger: 6.75
          spread: 20.75
          rows:
            top.key_net: P20
            home.key_net: P21
            bottom.key_net: P20
        middle:
          stagger: 3
          spread: 20
          rows:
            top.key_net: P20
            home.key_net: P21
            bottom.key_net: P20
        index:
          rotate: indexRotate
          stagger: -4
          spread: 22.25
          rows:
            top.key_net: P20
            home.key_net: P21
            bottom.key_net: P20
        inner:
          spread: 20.25
          stagger: -1
          rotate: innerRotate
          rows:
            top.key_net: P20
            home.key_net: P21
            bottom.key_net: P20
    thumbfan:
      anchor:
        ref: matrix_inner_bottom
        shift: [-7, -19]
      columns:
        home:
          rotate: thumbRotate
          spread: 11.25
          stagger: -2.25
          key.key_net: P6
        far:
          spread: 20
          key.key_net: P6
      rows:
        thumb:

    mcu:
      key:
        name: mcu
        height: 18
        width: 33
        key_net: P10
      anchor:
        - ref: matrix_pinky_bottom
          shift: [18, 0]
        - ref: thumbfan_home_thumb

outlines:
  exports:
    _panel:
      - type: polygon
        points:
          - ref: matrix_inner_bottom
            shift: [halfKeyW + paddingX, -halfKeyH - 4paddingY]
          - ref: thumbfan_far_thumb
            shift: [halfKeyW + paddingX, halfKeyH + paddingY]
          - ref: thumbfan_far_thumb
            shift: [halfKeyW + paddingX, -halfKeyH - paddingY]
          - ref: thumbfan_home_thumb
            shift: [-halfKeyW - 2paddingX, -halfKeyH - paddingY]
          - ref: matrix_pinky_bottom
            shift: [-halfKeyW - paddingX, -halfKeyH - 13]
          - ref: matrix_pinky_home
            shift: [-halfKeyW - paddingX, halfKeyH + paddingY]
          - ref: matrix_pinky_home
            shift: [halfKeyW + 3.5 paddingX, halfKeyH + paddingY]
          - ref: matrix_ring_top
            shift: [-halfKeyW - paddingX, halfKeyH + paddingY]
          - ref: matrix_ring_top
            shift: [halfKeyW + paddingX, halfKeyH + paddingY]
          - ref: matrix_middle_top
            shift: [-halfKeyW - paddingX, halfKeyH + paddingY]
          - ref: matrix_middle_top
            shift: [halfKeyW + paddingX, halfKeyH + paddingY]
          - ref: matrix_index_top
            shift: [-halfKeyW - 4.75 paddingX, halfKeyH + paddingY]
          - ref: matrix_index_top
            shift: [halfKeyW + paddingX, halfKeyH + paddingY]
          - ref: matrix_inner_top
            shift: [-halfKeyW - 2.75 paddingX, halfKeyH + paddingY]
          - ref: matrix_inner_top
            shift: [halfKeyW + paddingX, halfKeyH + paddingY]
    base_outline:
      - _panel
      - operation: stack
        type: keys
        side: left
        size: [cx - .5, cy - .5]
pcbs:
  main:
    outlines:
      main:
        outline: _panel
    footprints:
      - type: promicro
        anchor.ref: mcu
        params:
          orientation: up